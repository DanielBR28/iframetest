<!DOCTYPE html>
<html lang="en">
<body>
<h2>Entity Form</h2>
<form>
        <div style="margin: 10px 0px">
            <div>
                <div>
                    Agency Name *:
                </div>
                <div>
                    <input id="agency" type="text" value=""/>
                </div>
            </div>
            <div>
                <div>
                    Entity Type *:
                </div>
                <div>
                    <input id= "type" type="text" value=""/>
                </div>
            </div>
            
            <div>
                <div>
                    Description:
                </div>
                <div>
                    <textarea id= "description" type="text"></textarea>
                </div>
                <div></div>
            </div>
            <button id = "dataTrigger" label="Pull Data" onclick="pullData()">Pull Data</button>
            
            <button id = "clearData" onclick="clearData()" style="margin-left: 5px;">Clear Data</button>
        </div>
</form>


<script>
var message= { "pullData": true, "showBanner": true, "bannerMessage": "iframe's Data Request", "bannerDetail": "Pulled data from current entity"}

window.addEventListener('load', iframeListener, false);

function iframeListener()
{
	window.addEventListener('message', receiveMessage, false);
}

function receiveMessage(e)
{
	if (e.data.type === 'AgencyV2'){
		console.log('received data= ');
		console.log(e.data);
		const agency = <HTMLInputElement>document.getElementById('agency');
		agency.value = e.data.name;
		const type = <HTMLInputElement>document.getElementById('type');
		type.value = e.data.type;
		document.getElementById('description').innerHTML = e.data.header;
	}
}

function clearData()
	{
		const agency = <HTMLInputElement>document.getElementById('agency');
		agency.value = '';
		const type = <HTMLInputElement>document.getElementById('type');
		type.value = '';
		document.getElementById('description').innerHTML = '';
	}

function pullData() 
{
  window.parent.parent.postMessage(message, "http://localhost:4200/");
}
</script>
</body>
</html>
